"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});var f=(e=>(e.UserTokenGeneration="user:tokens_generation",e.UserPreMFA="user:pre_mfa",e.PostAuthentication="user:post_authentication",e.M2MTokenGeneration="m2m:token_generation",e.ExistingPasswordProvided="user:existing_password_provided",e.NewPasswordProvided="user:new_password_provided",e.PlanSelection="user:plan_selection",e.PlanCancellationRequest="user:plan_cancellation_request",e.UserPreRegistration="user:pre_registration",e.NewUsernameProvided="user:new_username_provided",e))(f||{}),u=(e=>(e.email="email",e.profile="profile",e.openid="openid",e.offline_access="offline",e))(u||{}),m=(e=>(e.none="none",e.create="create",e.login="login",e))(m||{});const p="0.9.0",y=p,d=(e,n)=>{if(!e||e.includes(".."))throw new Error("Invalid asset path");return`/${e}?${n?`p_org_code=${n}&`:""}cache=@8973ff883c2c40e1bad198b543e12b24@`},E={get(e,n,t){return Reflect.get(e,n.toString(),t)},set(e,n,t){return kinde.idToken.setCustomClaim(n,t),Reflect.set(e,n,t)}},C={get(e,n,t){return Reflect.get(e,n.toString(),t)},set(e,n,t){return kinde.accessToken.setCustomClaim(n,t),Reflect.set(e,n,t)}},_={get(e,n,t){return Reflect.get(e,n.toString(),t)},set(e,n,t){return kinde.m2mToken.setCustomClaim(n,t),Reflect.set(e,n,t)}};function S(){if(!kinde.idToken)throw new Error("IdToken binding not available, please add to workflow/page settings to enable");const e=kinde.idToken.getCustomClaims();return new Proxy(e,E)}function T(){if(!kinde.accessToken)throw new Error("accessToken binding not available, please add to workflow/page settings to enable");const e=kinde.accessToken.getCustomClaims();return new Proxy(e,C)}function F(){if(!kinde.m2mToken)throw new Error("m2mToken binding not available, please add to workflow/page settings to enable");const e=kinde.m2mToken.getCustomClaims();return new Proxy(e,_)}function c(e){if(!kinde.env)throw new Error("env binding not available, please add to workflow/page settings to enable");return kinde.env.get(e)}function K(e){if(!kinde.localization)throw new Error("localization binding not available, please add to workflow/page settings to enable");return kinde.localization.get(e)}function P(e){if(!kinde.auth)throw new Error("auth binding not available");kinde.auth.denyAccess(e)}function U(e,n){if(!kinde.widget)throw new Error("widget binding not available");kinde.widget.invalidateFormField(e,n)}async function I(e,n){if(!kinde.fetch)throw new Error("fetch binding not available");n.responseFormat||(n.responseFormat="json");const t=await kinde.fetch(e,n);return{data:n.responseFormat==="json"?t?.json:t.text}}function M(e){if(!kinde.mfa)throw new Error("mfa binding not available, please add to workflow settings to enable");kinde.mfa.setEnforcementPolicy(e)}async function j(e,n){if(!kinde.secureFetch)throw new Error("secureFetch binding not available");return n.responseFormat||(n.responseFormat="json"),{data:(await kinde.secureFetch(e,n))?.json}}async function k(e,n){const t=()=>{if(!n.domain||!n.clientId||!n.clientSecret)throw new Error("getM2MToken: Missing required parameters");try{const i=kinde.fetch(`${n.domain}/oauth2/token`,{method:"POST",responseFormat:"json",headers:{"content-type":"application/x-www-form-urlencoded",accept:"application/json",...n.headers},body:new URLSearchParams({audience:n.audience?.join(" ")??"",grant_type:"client_credentials",client_id:n.clientId,client_secret:n.clientSecret,scope:n.scopes?.join(" ")??""})});if(!i.json?.access_token)throw new Error("getM2MToken: No access token returned");return i.json.access_token}catch(i){throw new Error(`getM2MToken: Failed to obtain token - ${i.message}`)}};return n.skipCache?t():await kinde.cache.jwtToken(e,{validation:{key:{type:"jwks",jwks:{url:`${n.domain}/.well-known/jwks.json`}}},onMissingOrExpired:t})}async function $(e,n){let t,i;if(!URLSearchParams)throw new Error("url binding not available");if(n?.clientId&&n?.clientSecret)t=n.clientId,i=n.clientSecret;else if(n?.clientIdKey&&n?.clientSecretKey)t=c(n.clientIdKey)?.value,i=c(n.clientSecretKey)?.value;else{if(t=c("KINDE_WF_M2M_CLIENT_ID")?.value,i=c("KINDE_WF_M2M_CLIENT_SECRET")?.value,!t)throw new Error("M2M client ID not set");if(!i)throw new Error("M2M client secret not set")}let o=await k("internal_m2m_access_token",{domain:e.context.domains.kindeDomain,clientId:t,clientSecret:i,audience:[`${e.context.domains.kindeDomain}/api`],skipCache:n?.skipCache??!1});typeof o=="object"&&(o=JSON.stringify(o),o=o.replace('"\\"',""),o=o.replace('\\""',"")),o=o.replace(/"/g,"");const r=async({method:a,endpoint:h,params:l,contentType:v="application/json"})=>{let g;return l&&(g=a==="GET"?new URLSearchParams(l).toString():l),{data:(await kinde.fetch(`${e.context.domains.kindeDomain}/api/v1/${h}`,{method:a,responseFormat:"json",headers:{authorization:`Bearer ${o}`,"Content-Type":v,accept:"application/json"},body:g??void 0})).json}};return{get:async a=>await r({method:"GET",...a}),post:async a=>await r({method:"POST",...a}),patch:async a=>await r({method:"PATCH",...a}),put:async a=>await r({method:"PUT",...a}),delete:async a=>await r({method:"DELETE",...a})}}const w="@b1d3a51558e64036ad072b56ebae37f5@",b="@847681e125384709836f921deb311104@",R=()=>"@cd65da2987c740d58961024aa4a27194@",D=()=>"@43dffdf2c22f40e9981303cb383f6fac@",x=()=>"@ce0ef44d50f6408985f00c04a85d8430@",A=()=>"@8103c7ff23fe49edb9b0537d2927e74e@",L=()=>"@0c654432670c4d0292c3a0bc3c533247@",N=()=>w,V=()=>b,G=()=>w,q=()=>b,z=()=>"@09e41b34d7c04650aee6d26cafa152fc@",O=e=>d("logo",e),H=e=>d("logo_dark",e),J=e=>d("favicon_svg",e),Q=e=>d("favicon_fallback",e),X=e=>!e||/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$|^rgb\(.*\)$|^rgba\(.*\)$/.test(e),Y=e=>!e||/^(0|\d+(.(\d)+)?(%|px|rem|em))$/.test(e),Z=(...e)=>e.every(X)||void 0,W=(...e)=>e.every(Y)||void 0,B=({baseBackgroundColor:e,baseLinkColor:n,buttonBorderRadius:t,primaryButtonBackgroundColor:i,primaryButtonColor:s,cardBorderRadius:o,inputBorderRadius:r})=>{if(!Z(e,n,i,s))throw console.log("baseBackgroundColor: ",e),console.log("baseLinkColor: ",n),console.log("primaryButtonBackgroundColor: ",i),console.log("primaryButtonColor: ",s),new Error("Invalid color value provided");if(!W(t,o,r))throw console.log("buttonBorderRadius: ",t),console.log("cardBorderRadius: ",o),console.log("inputBorderRadius: ",r),new Error("Invalid border radius value provided");return[e&&`--kinde-designer-base-background-color: ${e};`,n&&`--kinde-designer-base-link-color: ${n};`,o&&`--kinde-designer-card-border-radius: ${o};`,t&&`--kinde-designer-button-border-radius: ${t};`,r&&`--kinde-designer-control-select-text-border-radius: ${r};`,i&&`--kinde-designer-button-primary-background-color: ${i};`,s&&`--kinde-designer-button-primary-color: ${s};`].filter(Boolean).join(`
`)},ee=(e,n)=>{if(!kinde.plan)throw new Error("plan binding not available, please add to workflow/page settings to enable");if(!e||typeof e!="string")throw new Error("Invalid message provided");kinde.plan.denySelection(e,n)},ne=e=>{if(!kinde.plan)throw new Error("plan binding not available, please add to workflow/page settings to enable");if(!e||typeof e!="string")throw new Error("Invalid message provided");kinde.plan.denyCancellation(e)};exports.PromptTypes=m;exports.Scopes=u;exports.WorkflowTrigger=f;exports.accessTokenCustomClaims=T;exports.createKindeAPI=$;exports.denyAccess=P;exports.denyPlanCancellation=ne;exports.denyPlanSelection=ee;exports.fetch=I;exports.getDarkModeLogoUrl=H;exports.getEnvironmentVariable=c;exports.getFallbackFaviconUrl=Q;exports.getKindeCSRF=L;exports.getKindeLoginUrl=V;exports.getKindeNonce=D;exports.getKindeRegisterUrl=N;exports.getKindeRequiredCSS=x;exports.getKindeRequiredJS=A;exports.getKindeSignInUrl=q;exports.getKindeSignUpUrl=G;exports.getKindeThemeCode=z;exports.getKindeWidget=R;exports.getLocalization=K;exports.getLogoUrl=O;exports.getM2MToken=k;exports.getSVGFaviconUrl=J;exports.idTokenCustomClaims=S;exports.invalidateFormField=U;exports.m2mTokenClaims=F;exports.secureFetch=j;exports.setEnforcementPolicy=M;exports.setKindeDesignerCustomProperties=B;exports.version=y;
